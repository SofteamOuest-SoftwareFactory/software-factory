- command: "kubectl get secret {{item.name}}"
  register: command_result
  ignore_errors: True
  
- command: "kubectl create secret docker-registry {{item.name}} --docker-server={{item.server}} --docker-username={{item.username}} --docker-password={{item.password}} --docker-email={{item.email}}"
  when: 'item.name not in command_result.stdout'